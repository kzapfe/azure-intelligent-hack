---
title: "setup details"
bg: orangelight
color: black
fa-icon: toggle-on
---

## Setup your development environment

This hackathon excercises the following platforms or services:

- Visual Studio 2017
- Xamarin (Xamarin.Forms)
- Azure Functions (C#/.NET)
- Azure Storage Account (blob)
- Azure Cosmos DB (SQL/DocumentDB)
- Cognitive Services Custom Vision

Recommended tools:

1. (Required) Visual Studio 2017 with the following packages installed:
- Mobile Development with .NET
- Azure Development
2. (Extension) Azure Functions and Web Jobs Tools version 15.0.31201.0 or higher
3. Visual Studio for Mac (optional for Android, required for iOS)
4. Postman

## Setup backend

Clone the project from GitHub repo:

`git clone https://github.com/rcervantes/cognitive-locator.git`

Click on the button Deploy to Azure to configure and recreate the Azure resources:

<div style="text-align:center">
  <img src="https://azuredeploy.net/deploybutton.png" />
</div>

Parameters:

- **Directory:** name of the directory that hosts your subscription.
- **Subscription:** name of the subscription you want to perform the deployment.
- **Resource Group:** confirm to create a new resource group.
- **Resource Group Name:** name of the resource group you want to use.
- **Site Location:** name of the location of the resource group and all the resources.
- **Storage Account Type:** type of storage: locally redundant storage (LRS), geo-redundant storage (GRS) or read-access geo-redundant storage (RA-GRS).
- **Database Consistency Level:** session is default, but the CosmosDB parameters are: eventual, strong, session, boundedstaleness.
- **Database Max Staleness Prefix:** 10 is default.
- **Database Max Interval In Seconds:** 5 is default.
- **Face Api Pricing Tier:** S0 is default, F0 (20 calls per minute, 30K calls per month) or S0 (10 calls per second).

<div style="text-align:center">
  <img src="http://rcervantes.me/images/cognitive-locator-azure-deploy.png" width="500" />
</div>

<br />

<div style="text-align:center">
  <img src="http://rcervantes.me/images/cognitive-locator-azure-deploy2.png" width="500" />
</div>

<br />

After create the resources you can validate it in your portal, e.g.:

- **Resource Group:** cognitive-locatora037
- **Azure Service Plan:** cognitive-locatora037-asp
- **Azure Database:** cognitive-locatora037-cos
- **Face API:** cognitive-locatora037-fac
- **Azure Function:** cognitive-locatora037-fun
- **Azure Notification Namespace:** cognitive-locatora037-ns
- **Azure Notification Hub:** cognitive-locatora037-hub
- **Storage:** (unique-identifier)stg

<div style="text-align:center">
  <img src="http://rcervantes.me/images/cognitive-locator-resources.png" width="500" />
</div>

<br />

At this point you have to ways to configure the backend: **using a shell script** or **manually**.

#### Using a shell script

To execute the automation there are two prerequisites:

1. install [Azure CLI](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest).

2. install [JQ](https://stedolan.github.io/jq/download/).

3. open a terminal go to the root of your repository: cognitive-locator, then write: chmod 700 azureconfig.sh, this allow us to run the script.

4. run the script: ./azureconfig.sh.

5. open a navigation tab and paste the authentication code provided in the url: https://aka.ms/devicelogin.

6. select the id of the subscription you have previously deployed the resources.

7. validate the correct subscription and type yes.

8. paste the name of the resource group name you did the deploy.

9. now, the database has been configured and will prompt the region for Face API, use the same as you selected in the One-Click-Deploy site location.

10. once, the database and face api has been configured you will need to add the cryptography key, the app center key for android and ios and you will finish the automation configuration.

11. since notification hub configuration is not available yet in Azure CLI you will manually need to add the missing configuration, go to Azure Function App application settings and configure the NotificationHub_Access_Signature setting.

12. the application uses Facebook Authentication you need to follow the steps provided here: **[Adding Facebook Authentication](#adding-facebook-authentication)** provided in this document.

13. publish the azure function app to the cloud, all the settings needed are already configured.

#### Manually

1. go to your cosmosdb database account and create a database and database collection:
* database name: CognitiveLocator.
* database collection: Person.

2. configure the face api settings following the steps provided here: **[Configure Face API](#configure-face-api)**.

3. you need to configure all the application settings required in the azure function app:
* "AzureWebJobsStorage": "AZURE_STORAGE_CONNECTION_STRING",
* "AzureWebJobsDashboard": "AZURE_STORAGE_CONNECTION_STRING",
* "Face_API_Subscription_Key": "FACE_API_KEY",
* "Face_API_PersonGroupId": "missingpeople",
* "Face_API_Zone": "FACE_API_ZONE(e.g. westus or southcentralus)",
* "Face_API_FaceList": "list",
* "CosmosDB_URI": "COSMOSDB_URI",
* "CosmosDB_AuthKey": "COSMOSDB_KEY",
* "CosmosDB_DatabaseId": "CognitiveLocator",
* "CosmosDB_PersonCollection": "Person",
* "NotificationHub_Access_Signature": "NOTIFICATION_HUB_CONNECTION_STRING",
* "NotificationHub_Name": "NOTIFICTION_HUB_NAME",
* "Cryptography_Key": "CRYPT_KEY",
* "MobileCenterID_Android": "MOBILECENTER_ANDROID_APP_ID",
* "MobileCenterID_iOS": "MOBILECENTER_IOS_APP_ID",
* "ImageStorageUrl": "https://YOUR_STORAGE_ACCOUNT.blob.core.windows.net/images/"

4. the application uses Facebook Authentication you need to follow the steps provided here: **[Adding Facebook Authentication](#adding-facebook-authentication)** provided in this document.

5. publish the azure function app to the cloud.
